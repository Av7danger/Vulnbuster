<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pentest Report - {{ client_name or 'Client' }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f8f9fa; }
        .header { background: #222; color: #fff; padding: 2em; text-align: center; }
        .section { margin: 2em auto; max-width: 900px; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #ccc; padding: 2em; }
        h1, h2, h3 { color: #222; }
        .finding { border-left: 4px solid #d9534f; margin: 1.5em 0; padding: 1em; background: #f9ecec; }
        .ai { color: #0275d8; font-style: italic; }
        .poc { background: #f7f7f9; border: 1px solid #e1e1e8; padding: 1em; margin: 1em 0; font-family: monospace; }
        .exploit-chain { background: #eaf7ea; border-left: 4px solid #5cb85c; padding: 1em; margin: 1em 0; }
        .dynamic { background: #e9f5fb; border-left: 4px solid #5bc0de; padding: 1em; margin: 1em 0; }
        .footer { text-align: center; color: #888; margin: 2em 0 1em 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Pentest Report</h1>
        <h2>{{ client_name or 'Client' }}</h2>
        <p><strong>Date:</strong> {{ scan_results.metadata.scan_date or 'N/A' }}</p>
    </div>
    <div class="section">
        <h2>Executive Summary</h2>
        <p class="ai">{{ scan_results.ai_summary or 'No AI summary available.' }}</p>
    </div>
    <div class="section">
        <h2>Findings</h2>
        {% for finding in scan_results.security_issues %}
            <div class="finding">
                <h3>{{ finding.type|capitalize }}</h3>
                <p><strong>Location:</strong> {{ finding.file or finding.url or 'N/A' }}</p>
                <p><strong>Description:</strong> {{ finding.description or 'N/A' }}</p>
                <p><strong>Severity:</strong> {{ finding.severity or 'info' }}</p>
                <p><strong>Value:</strong> {{ finding.value or 'N/A' }}</p>
                {% if finding.ai_explanation %}
                    <p class="ai"><strong>AI Explanation:</strong> {{ finding.ai_explanation }}</p>
                {% endif %}
                {% if finding.remediation %}
                    <p><strong>Remediation:</strong> {{ finding.remediation }}</p>
                {% endif %}
                {% if finding.ai_poc %}
                    <div class="poc"><strong>AI PoC:</strong><br>{{ finding.ai_poc }}</div>
                {% endif %}
            </div>
        {% else %}
            <p>No findings detected.</p>
        {% endfor %}
    </div>
    <div class="section">
        <h2>Exploit Chain</h2>
        <div class="exploit-chain">{{ scan_results.ai_exploit_chain or 'No exploit chain generated.' }}</div>
    </div>
    <div class="section">
        <h2>Dynamic Analysis</h2>
        <div class="dynamic">
            <pre>{{ scan_results.dynamic_analysis | tojson(indent=2) }}</pre>
        </div>
    </div>
    <div class="footer">
        VulnBuster &copy; {{ now().year }} | Automated Pentest Report
    </div>
</body>
</html> 